{% load i18n unfold %}
{% load static %}
{% if sidebar_navigation %}
    <div class="h-0 grow overflow-auto" data-simplebar>
        {% for group in sidebar_navigation %}
            {% if group.items %}
                {% has_nav_item_active group.items as has_active %}

                <div class="hidden mb-2 has-[ol]:has-[li]:block" {% if group.collapsible %}x-data="{navigationOpen: {% if has_active %}true{% else %}false{% endif %}}"{% endif %}>
                    {% if group.separator %}
                        <hr class="border-t border-base-200 mx-6 my-2 dark:border-base-800" />
                    {% endif %}

                    {% if group.title %}
                        <h2 class="font-semibold flex flex-row group items-center mb-1 mx-3 py-1.5 px-3 select-none text-font-important-light text-sm dark:text-font-important-dark {% if group.collapsible %}cursor-pointer hover:text-primary-600 dark:hover:text-primary-500{% endif %}" {% if group.collapsible %}x-on:click="navigationOpen = !navigationOpen"{% endif %}>
                            {% if group.title == "کانتینو" %}
                                {% comment %} <img src="{% static 'logo/contino1.svg' %}" class="h-[18px] w-[18px] mr-3" alt="contino"> {% endcomment %}
                                <svg class="h-[18px] w-[18px] mr-3" viewBox="0 0 42 29" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M37.56 18.32C37.48 18.51 37.4 18.69 37.32 18.88C37.03 19.49 36.69 20.08 36.28 20.65C35.78 21.28 35.2 21.82 34.57 22.27C34.55 22.28 34.54 22.3 34.52 22.31C34.36 22.42 34.2 22.52 34.03 22.61C32.79 23.33 31.34 23.75 29.8 23.75C26.26 23.75 23.23 21.56 21.98 18.47C22.19 18.77 22.43 19.05 22.7 19.32C24 20.63 25.74 21.35 27.59 21.35C30.15 21.35 32.45 19.95 33.64 17.73C33.77 17.5 33.89 17.25 33.99 17C34.06 16.82 34.17 16.66 34.28 16.5C34.33 16.43 34.39 16.36 34.45 16.3C34.53 16.22 34.61 16.15 34.7 16.08C35.55 15.47 36.77 15.71 37.34 16.56C37.35 16.56 37.36 16.59 37.37 16.6C37.7 17.11 37.77 17.74 37.56 18.32Z" fill="currentColor"/>
                                <path d="M31.38 24.37C31.32 24.4 31.25 24.43 31.18 24.45C30.97 24.52 30.76 24.59 30.55 24.65C30.33 24.72 30.1 24.77 29.88 24.82C29.79 24.84 29.7 24.86 29.61 24.88H29.58C29.48 24.9 29.38 24.91 29.28 24.93C29.25 24.93 29.23 24.95 29.2 24.95C28.86 25 28.51 25.04 28.16 25.06C28.02 25.06 27.88 25.06 27.74 25.06C27.53 25.06 27.33 25.06 27.12 25.06C27 25.05 26.87 25.04 26.75 25.03C26.72 25.02 26.69 25.02 26.66 25.02C21.68 24.51 17.73 20.56 17.21 15.59C17.21 15.59 17.21 15.5833 17.21 15.57C17.22 10.97 20.93 7.22997 25.51 7.15997H25.64C26.15 7.15997 26.64 7.19997 27.12 7.28997H27.13C27.44 7.34997 27.74 7.41997 28.03 7.49997C27.9 7.49997 27.77 7.49997 27.63 7.49997H27.61C27.19 7.49997 26.77 7.53997 26.36 7.61997H26.35C25 7.86997 23.75 8.53997 22.74 9.53997C22.53 9.74997 22.34 9.96997 22.16 10.2C22.14 10.23 22.12 10.26 22.1 10.29C21.34 11.29 20.87 12.45 20.75 13.68C20.65 14.22 20.6 14.76 20.6 15.32C20.6 19.29 23.11 22.67 26.64 23.96H26.65C27.18 24.16 27.73 24.31 28.31 24.39C28.79 24.48 29.29 24.52 29.8 24.52C30.34 24.52 30.87 24.47 31.38 24.38V24.37Z" fill="currentColor"/>
                                <path d="M29.2798 24.93C29.4798 24.9 29.6798 24.87 29.8798 24.82C29.7898 24.84 29.6998 24.86 29.6098 24.88C29.5598 24.89 29.5198 24.9 29.4698 24.91C29.4098 24.92 29.3498 24.93 29.2798 24.93Z" fill="#E11B50"/>
                                <path d="M29.65 14.29C29.65 16.14 28.16 17.64 26.31 17.64C24.46 17.64 22.96 16.14 22.96 14.29C22.96 12.9 23.8 11.71 25.01 11.2C25.12 11.81 25.66 12.27 26.31 12.27C26.96 12.27 27.49 11.81 27.61 11.2C28.81 11.71 29.65 12.9 29.65 14.29Z" fill="currentColor"/>
                                <path d="M20.9001 5.46002C20.6501 5.54002 16.7001 6.91002 15.2101 7.63002C5.2401 12.44 3.9101 21.21 3.8501 21.61C6.0701 20.73 8.5001 20.25 11.0301 20.25C14.0001 20.25 16.8301 20.91 19.3601 22.1C17.5101 20.09 16.4001 17.42 16.4001 14.49C16.4001 10.8 18.1701 7.53002 20.9001 5.46002ZM15.3401 15.08C15.3401 15.08 15.3301 15.08 15.3201 15.09C15.3001 15.1 15.2601 15.11 15.2001 15.13C15.0101 15.19 14.6201 15.31 14.0901 15.5C13.8301 15.6 13.5701 15.69 13.3001 15.79C12.9201 15.93 12.5101 16.1 12.0701 16.28C11.6901 16.43 11.2901 16.61 10.8801 16.8C10.7401 16.85 10.6101 16.92 10.4701 16.98C10.0301 17.18 9.6101 17.4 9.1901 17.63C8.9701 17.75 8.7501 17.86 8.5401 17.99C7.3101 18.67 6.0901 19.48 5.0301 20.4C5.0901 20.16 5.3201 19.89 5.4601 19.69C5.6301 19.46 5.8101 19.23 6.0001 19.02C6.2001 18.8 6.4101 18.6 6.6401 18.41H6.6501C6.6501 18.41 6.8701 18.21 7.2801 17.91C8.5101 17 11.4601 15.05 15.3401 13.99V15.08Z" fill="currentColor"/>
                                <path d="M37.9001 11.18C37.9901 11.64 37.8701 12.11 37.6001 12.5C37.5601 12.56 37.5201 12.61 37.4701 12.66C37.1301 13.05 36.6501 13.27 36.1301 13.27H35.9201C35.1701 13.27 34.5001 12.8 34.2101 12.06C34.0901 11.76 33.9601 11.46 33.7901 11.18C33.5201 10.67 33.1601 10.2 32.7401 9.77002C32.7301 9.75002 32.7001 9.72002 32.6701 9.69002C32.5601 9.56002 32.4501 9.44002 32.3301 9.31002C32.1101 9.07002 31.8701 8.83002 31.6101 8.62002C31.4901 8.51002 31.3601 8.41002 31.2301 8.31002C31.0901 8.21002 30.9601 8.11002 30.8201 8.02002C30.6901 7.92002 30.5501 7.83002 30.4101 7.75002C30.2801 7.66002 30.1501 7.58002 30.0101 7.51002C30.0001 7.50002 29.9901 7.50002 29.9801 7.50002C29.8401 7.42002 29.6901 7.35002 29.5401 7.28002C29.3901 7.21002 29.2401 7.14002 29.0901 7.08002C28.4801 6.84002 27.8401 6.65002 27.1801 6.54002C26.6801 6.44002 26.1601 6.40002 25.6401 6.40002C22.3201 6.40002 19.4401 8.16002 17.8101 10.77C19.0801 7.50002 21.9301 4.95002 25.3901 4.14002C25.9101 4.01002 26.4501 3.93002 27.0001 3.89002C27.4801 3.86002 28.8601 3.79002 30.5801 4.06002C32.3601 4.33002 34.5001 4.95002 36.3801 6.33002L34.7401 6.11002C36.2201 7.12002 37.9901 8.63002 38.2701 10.29L37.3201 9.63002L37.2401 9.57002C37.4601 9.98002 37.6501 10.4 37.8101 10.84C37.8501 10.95 37.8801 11.06 37.9001 11.18Z" fill="currentColor"/>
                                <path d="M15.1998 15.13C15.0898 15.18 14.9398 15.23 14.8898 15.24C14.6198 15.32 14.3498 15.41 14.0898 15.5C14.6198 15.31 15.0098 15.19 15.1998 15.13Z" fill="white"/>
                                <path opacity="0.47" d="M15.1998 15.13C15.0898 15.18 14.9398 15.23 14.8898 15.24C14.6198 15.32 14.3498 15.41 14.0898 15.5C14.6198 15.31 15.0098 15.19 15.1998 15.13Z" fill="white"/>
                                </svg>

                            {% elif group.icon %}
                                <span class="material-symbols-outlined md-18 mr-3">
                                    {{ group.icon }}
                                </span>
                            {% endif %}
                                    
                            {{ group.title }}

                            {% if group.collapsible %}
                                <span class="material-symbols-outlined ml-auto transition-all group-hover:text-primary-600 dark:group-hover:text-primary-500" x-bind:class="{'rotate-90': navigationOpen}">
                                    chevron_right
                                </span>
                            {% endif %}
                        </h2>
                    {% endif %}

                    <ol class="flex flex-col gap-1 px-6" {% if group.collapsible %}x-show="navigationOpen"{% endif %}>
                        {% for item in group.items %}
                            {% if item.has_permission %}
                                <li>
                                    <a href="{% if item.link_callback %}{{ item.link_callback }}{% else %}{{ item.link }}{% endif %}" class="flex h-[38px] items-center -mx-3 px-3 rounded-default hover:text-primary-600 dark:hover:text-primary-500 {% if item.active %}bg-base-100 font-semibold text-primary-600 dark:bg-white/[.06] dark:text-primary-500{% endif %}">
                                        {% if item.icon %}
                                            <span class="material-symbols-outlined md-18 mr-3 w-[18px]">
                                                {{ item.icon }}
                                            </span>
                                        {% endif %}

                                        <span class="text-sm">
                                            {{ item.title|safe }}
                                        </span>

                                        {% if item.badge %}
                                            <span class="bg-red-600 font-semibold ml-2 px-1 relative rounded-xs text-xs text-white">
                                                {% if item.badge_callback %}
                                                    {{ item.badge_callback }}
                                                {% else %}
                                                    {{ item.badge }}
                                                {% endif %}
                                            </span>
                                        {% endif %}
                                    </a>
                                </li>
                            {% endif %}
                        {% endfor %}
                    </ol>
                </div>
            {% endif %}
        {% endfor %}
    </div>

    {% if sidebar_show_all_applications and app_list|length > 0 %}
        <div class="mt-auto" x-data="{ openAllApplications: false }">
            <a class="cursor-pointer flex items-center h-[64px] px-6 py-3 text-sm dark:text-font-default-dark hover:text-primary-600 dark:hover:text-primary-500" x-on:click="openAllApplications = !openAllApplications">
                <span class="material-symbols-outlined md-18 mr-3">
                    apps
                </span>

                <span>
                    {% trans "All applications" %}
                </span>
            </a>

            <div class="absolute bottom-0 left-0 right-0 top-0 z-50 md:left-72" x-cloak x-show="openAllApplications">
                <div class="absolute bg-base-900/80 backdrop-blur-xs bottom-0 left-0 right-0 top-0 z-10 w-screen"></div>

                <div class="bg-white flex flex-col h-full overflow-x-hidden overflow-y-auto py-5 px-8 relative text-sm w-80 z-20 dark:bg-base-900 dark:border-r dark:border-base-800" x-on:click.outside="openAllApplications = false" x-on:keydown.escape.window="openAllApplications = false">
                    {% for app in app_list %}
                        <div class="mb-6 last:mb-0">
                            <h2 class="mb-4 font-semibold text-font-important-light truncate dark:text-font-important-dark">
                                {{ app.name }}
                            </h2>

                            <ul>
                                {% for model in app.models %}
                                    <li class="block mb-4 last:mb-0">
                                        <a href="{{ model.admin_url }}" class="block truncate hover:text-primary-600 dark:hover:text-primary-500">
                                            {{ model.name }}
                                        </a>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    {% endif %}
{% else %}
    <p>
        {% trans "You don’t have permission to view or edit anything." as error_message %}
        {% include "unfold/helpers/messages/error.html" with error=error_message %}
    </p>
{% endif %}
